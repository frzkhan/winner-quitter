(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{364:function(e,t,r){"use strict";r.r(t);r(171),r(69);var n=r(14),c=r(359),o=r.n(c),l={middleware:"axios",name:"project",data:function(){return{isUserSelected:null,rating:null}},asyncData:function(){var e=Object(n.a)(regeneratorRuntime.mark(function e(t){var r,n,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.route.params.id,e.next=3,t.$axios.$post("/api/Tasks/submissions",{taskId:r});case 3:return n=e.sent,c=!!n.submissions.find(function(s){return s.selected}),l=n.submissions.filter(function(s){return s.selected}),c&&(n.submissions=l),n.submissions=o.a.orderBy(n.submissions,["metrics.expert","metrics.reliability","metrics.interest","metrics.availability"],["desc","desc","desc","desc"]),e.abrupt("return",{project:n});case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),created:function(){var e=this;this.isUserSelected=this.project.submissions.find(function(sub){return sub.userId===e.$store.state.user.id&&sub.selected&&!sub.canceled})},methods:{getProject:function(){var e=Object(n.a)(regeneratorRuntime.mark(function e(t){var r,n,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$axios.$post("/api/Tasks/submissions",{taskId:t});case 2:return r=e.sent,n=!!r.submissions.find(function(s){return s.selected}),c=r.submissions.filter(function(s){return s.selected}),n&&(r.submissions=c),e.abrupt("return",r);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),select:function(){var e=Object(n.a)(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.$store.state.user.id,e.next=3,this.$axios.$patch("/api/Submissions/".concat(t),{selected:!0,selectedDate:(new Date).toISOString()});case 3:return e.sent,alert("Selected"),e.next=7,this.getProject(this.project.id);case 7:this.project=e.sent;case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),deliver:function(){var e=Object(n.a)(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.$store.state.user.id,e.next=3,this.$axios.$patch("/api/Submissions/".concat(t),{delivered:!0,deliveredDate:(new Date).toISOString()});case 3:return e.sent,alert("Delivered"),e.next=7,this.getProject(this.project.id);case 7:this.project=e.sent;case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),cancel:function(){var e=Object(n.a)(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.$store.state.user.id,e.next=3,this.$axios.$patch("/api/Submissions/".concat(t),{canceled:!0,selected:!1});case 3:return e.sent,alert("Canceled"),e.next=7,this.getProject(this.project.id);case 7:this.project=e.sent;case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),approve:function(){var e=Object(n.a)(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.rating){e.next=3;break}return alert("please rate the work before approval"),e.abrupt("return");case 3:return this.$store.state.user.id,e.next=6,this.$axios.$patch("/api/Submissions/".concat(t),{completed:!0,completedDate:(new Date).toISOString(),rated:this.rating});case 6:return e.sent,alert("Approved"),e.next=10,this.getProject(this.project.id);case 10:this.project=e.sent;case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}},d=r(32),component=Object(d.a)(l,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{},[r("h1",[e._v(e._s(e.project.name))]),e._v(" "),r("small",[e._v("Total Prize: "+e._s(e.project.totalPrize)+" | Duration: "+e._s(e.project.duration))]),e._v(" "),r("p",[e._v(e._s(e.project.description))]),e._v(" "),r("p",[e._v("Skills Required: "+e._s(e.project.skills))]),e._v(" "),r("br"),e._v(" "),r("br"),e._v(" "),"client"==e.$store.state.user.realm?r("div",{},[r("h2",[e._v("Submissions")]),e._v(" "),e.project.submissions.length?e._e():r("p",[e._v("No applications")]),e._v(" "),r("b-list-group",{staticClass:"mt-5"},e._l(e.project.submissions,function(sub){return r("b-list-group-item",{key:sub.id},[r("div",{staticClass:"row"},[r("div",{staticClass:"col-6"},[e._v("\n            "+e._s(sub.user.profile.name)+" - "+e._s(sub.user.email)+" "),r("br"),e._v("\n            Availability: "+e._s(sub.metrics.availability)+" |\n            Expert: "+e._s(sub.metrics.expert)+" |\n            Interest: "+e._s(sub.metrics.interest)+" |\n            Reliability: "+e._s(sub.metrics.reliability)+"\n          ")]),e._v(" "),r("div",{staticClass:"col-6"},[sub.selected||sub.canceled?e._e():r("button",{staticClass:"float-right",attrs:{type:"button",name:"button"},on:{click:function(t){return e.select(sub.id)}}},[e._v("Select")]),e._v(" "),sub.selected&&!sub.delivered?r("p",{staticClass:"float-right badge badge-primary"},[e._v("Selected, waiting for delivery")]):e._e(),e._v(" "),sub.canceled?r("p",{staticClass:"badge badge-primary"},[e._v("Canceled")]):e._e(),e._v(" "),sub.delivered&&!sub.completed?r("div",{staticClass:"float-right"},[e._v("\n              Rate: "),r("select",{directives:[{name:"model",rawName:"v-model",value:e.rating,expression:"rating"}],attrs:{name:""},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.rating=t.target.multiple?r:r[0]}}},[r("option",{attrs:{value:"1"}},[e._v("1")]),e._v(" "),r("option",{attrs:{value:"2"}},[e._v("2")]),e._v(" "),r("option",{attrs:{value:"3"}},[e._v("3")]),e._v(" "),r("option",{attrs:{value:"4"}},[e._v("4")]),e._v(" "),r("option",{attrs:{value:"5"}},[e._v("5")])]),e._v(" "),r("button",{attrs:{type:"button",name:"button"},on:{click:function(t){return e.approve(sub.id)}}},[e._v("Approve")])]):e._e(),e._v(" "),sub.completed?r("div",{staticClass:"float-right"},[e._v("\n              Rated: "+e._s(sub.rated)+"\n            ")]):e._e()])])])}),1)],1):e._e(),e._v(" "),"worker"==e.$store.state.user.realm?r("div",{},[e.isUserSelected&&!e.isUserSelected.delivered?r("p",[e._v("You were selected for this task")]):e._e(),e._v(" "),e.isUserSelected&&!e.isUserSelected.delivered?r("button",{attrs:{type:"button",name:"button"},on:{click:function(t){return e.deliver(e.isUserSelected.id)}}},[e._v("Deliver Project")]):e._e(),e._v(" "),e.isUserSelected&&!e.isUserSelected.delivered?r("button",{attrs:{type:"button",name:"button"},on:{click:function(t){return e.cancel(e.isUserSelected.id)}}},[e._v("Cancel Project")]):e._e(),e._v(" "),e.isUserSelected&&e.isUserSelected.delivered&&!e.isUserSelected.completed?r("p",{staticClass:"badge badge-primary"},[e._v("Project Delivered, waiting for approval")]):e._e()]):e._e()])},[],!1,null,null,null);t.default=component.exports}}]);